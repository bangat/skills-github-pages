// [ë³´ì•ˆ ìˆ˜ì •] ë¡œê·¸ì¸ ë¡œì§ì„ ì„œë²„ ì¸¡ì—ì„œ ì²˜ë¦¬í•˜ë„ë¡ ë³€ê²½
async function tryLogin() {
    // ğŸš¨ ì¤‘ìš”: ì´ URLì„ ì‹¤ì œ ë°°í¬ëœ checkAdminPassword í•¨ìˆ˜ URLë¡œ êµì²´í•´ì•¼ í•©ë‹ˆë‹¤!
    const checkPasswordUrl = 'https://us-central1-hallymlinen.cloudfunctions.net/checkAdminPassword';

    // ë¡œë”© í‘œì‹œ
    const okButton = el("#adminOk");
    const originalText = okButton.textContent;
    okButton.disabled = true;
    okButton.textContent = 'í™•ì¸ ì¤‘...';

    try {
        const response = await fetch(checkPasswordUrl, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                pin: pin
            }) // ì…ë ¥ëœ PINì„ ì„œë²„ë¡œ ì „ì†¡
        });

        const result = await response.json();

        // [ìˆ˜ì •ëœ ë¶€ë¶„] â¬…ï¸ ë°”ë¡œ ì´ ë¶€ë¶„ì…ë‹ˆë‹¤!
        if (response.ok && result.success && result.token) {
            // 1. ë°›ì€ í† í°ì„ ë¸Œë¼ìš°ì €ì˜ localStorageì— ì €ì¥í•©ë‹ˆë‹¤.
            localStorage.setItem('adminToken', result.token);

            // 2. ëª¨ë‹¬ì„ ë‹«ê³  ì¶œê·¼ë¶€ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.
            closeModal("#adminModal");
            location.href = "ì¶œê·¼ë¶€.html";
        } else {
            clearPin();
            $in.placeholder = "ì¸ì¦ì˜¤ë¥˜.";
            try {
                playSnd("#warnSound");
            } catch (_) {}
            $ok.focus();
        }
    } catch (error) {
        // ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ë˜ëŠ” ì„œë²„ í•¨ìˆ˜ ë¬¸ì œ ì²˜ë¦¬
        console.error('ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì¤‘ ì˜¤ë¥˜:', error);
        clearPin();
        $in.placeholder = "ì¸ì¦ ì˜¤ë¥˜";
        try {
            playSnd("#warnSound");
        } catch (_) {}
        $ok.focus();
    } finally {
        // ë²„íŠ¼ ìƒíƒœ ë³µì›
        okButton.disabled = false;
        okButton.textContent = originalText;
    }
}
